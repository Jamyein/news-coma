# News Coma - æ™ºèƒ½æ–°é—»èšåˆç³»ç»Ÿ

## æ¦‚è¿°

News Coma æ˜¯ä¸€ä¸ªæ™ºèƒ½æ–°é—»èšåˆç³»ç»Ÿï¼Œæ”¯æŒ14å®¶å›½å†…å¤–LLMæä¾›å•†ï¼Œå…·å¤‡**1-Pass**å’Œ**2-Pass**ä¸¤ç§è¯„åˆ†ç³»ç»Ÿï¼Œèƒ½å¤Ÿæ™ºèƒ½ç­›é€‰å’Œæ€»ç»“æ–°é—»ã€‚

> **ğŸ‰ æ–°åŠŸèƒ½**: 1-Passè¯„åˆ†ç³»ç»Ÿç°å·²å¯ç”¨ï¼ç›¸æ¯”2-Passå‡å°‘50% APIè°ƒç”¨ï¼Œå¤„ç†æ—¶é—´ç¼©çŸ­70%ã€‚

## æ ¸å¿ƒç‰¹æ€§

### ğŸš€ 1-Pass è¯„åˆ†ç³»ç»Ÿï¼ˆæ–°ï¼ï¼‰
- **æè‡´ç®€åŒ–**ï¼šä»2-passçš„3500è¡Œä»£ç å‡å°‘åˆ°750è¡Œï¼Œé™ä½80%ä»£ç å¤æ‚åº¦
- **æ€§èƒ½æå‡**ï¼šAPIè°ƒç”¨å‡å°‘50%ï¼Œå¤„ç†æ—¶é—´ç¼©çŸ­70%
- **é…ç½®ç®€åŒ–**ï¼šä»20+é…ç½®é¡¹å‡å°‘åˆ°8é¡¹æ ¸å¿ƒé…ç½®
- **å•æ¬¡è°ƒç”¨**ï¼šåˆ†ç±»+è¯„åˆ†+æ€»ç»“ä¸€æ¬¡APIè°ƒç”¨å®Œæˆ
- **æ˜“äºç»´æŠ¤**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ ¸å¿ƒç»„ä»¶ä»…4ä¸ªæ–‡ä»¶

### ğŸš€ 2-Pass è¯„åˆ†ç³»ç»Ÿ
- **å·®å¼‚åŒ–å¤„ç†**ï¼šè´¢ç»ã€ç§‘æŠ€ã€ç¤¾ä¼šæ”¿æ²»ä¸‰å¤§æ¿å—ä½¿ç”¨ä¸åŒè¯„åˆ†æ ‡å‡†
- **å®½æ¾é¢„ç­› + ä¸¥æ ¼ç²¾é€‰**ï¼šPass 1 å¿«é€Ÿè¿‡æ»¤ï¼ŒPass 2 æ·±åº¦è¯„åˆ†
- **å›ºå®šæ¯”ä¾‹è¾“å‡º**ï¼š40%è´¢ç» + 30%ç§‘æŠ€ + 30%ç¤¾ä¼šæ”¿æ²»

### ğŸ”Œ å¤šæä¾›å•†æ”¯æŒ
- æ”¯æŒ14å®¶LLMæä¾›å•†ï¼šGemini, OpenAI, Claude, DeepSeek, æ™ºè°±, Kimi, é€šä¹‰åƒé—®ç­‰
- è‡ªåŠ¨å›é€€æœºåˆ¶ï¼šä¸»æä¾›å•†å¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨æä¾›å•†
- çœŸæ‰¹å¤„ç†ï¼šä¸€æ¬¡APIè°ƒç”¨å¤„ç†å¤šæ¡æ–°é—»ï¼Œå¤§å¹…é™ä½APIæˆæœ¬

### ğŸ“Š æ™ºèƒ½åŠŸèƒ½
- AIè¯„åˆ†ï¼šåŸºäº5ç»´åº¦æ ‡å‡†å¯¹æ–°é—»è¿›è¡Œè¯„åˆ†
- è‡ªåŠ¨ç¿»è¯‘ï¼šè‹±æ–‡æ–°é—»è‡ªåŠ¨ç¿»è¯‘ä¸ºä¸­æ–‡
- æ™ºèƒ½æ€»ç»“ï¼šç”Ÿæˆ200å­—å·¦å³çš„ä¸­æ–‡æ€»ç»“
- å…³é”®è¦ç‚¹ï¼šæå–3-5ä¸ªå…³é”®è¦ç‚¹
- è¯­ä¹‰å»é‡ï¼šTF-IDFè½»é‡çº§è¯­ä¹‰å»é‡

### âš¡ æ€§èƒ½ä¼˜åŒ–
- **1-Passæ¶æ„**ï¼šç›¸æ¯”2-Passå‡å°‘50% APIè°ƒç”¨ï¼Œå¤„ç†æ—¶é—´ä»15åˆ†é’Ÿç¼©çŸ­è‡³3-5åˆ†é’Ÿ
- **å¹¶è¡Œæ‰¹å¤„ç†**ï¼šæ”¯æŒå¤šæ‰¹æ¬¡å¹¶è¡Œå¤„ç†ï¼Œå……åˆ†åˆ©ç”¨APIå¹¶å‘èƒ½åŠ›
- **è¶…æ—¶ä¿æŠ¤**ï¼šæ‰¹æ¬¡çº§åˆ«è¶…æ—¶æ§åˆ¶ï¼Œé˜²æ­¢æ…¢æ‰¹æ¬¡æ‹–ç´¯æ•´ä½“æµç¨‹
- **æ™ºèƒ½é™çº§**ï¼šè¶…æ—¶åè‡ªåŠ¨é™çº§ä¸ºå•æ¡å¤„ç†æˆ–ä½¿ç”¨é»˜è®¤åˆ†æ•°

## 1-Pass vs 2-Pass å¯¹æ¯”

| ç‰¹æ€§ | 1-Pass (æ–°) | 2-Pass |
|------|------------|--------|
| **ä»£ç é‡** | ~750è¡Œ | ~3500è¡Œ |
| **é…ç½®é¡¹** | 8é¡¹ | 20+é¡¹ |
| **APIè°ƒç”¨** | 1æ¬¡/æ‰¹ | 2æ¬¡/æ‰¹ |
| **å¤„ç†æ—¶é—´** | ~4åˆ†é’Ÿ | ~12åˆ†é’Ÿ |
| **ç»´æŠ¤éš¾åº¦** | ç®€å• | å¤æ‚ |
| **åŠŸèƒ½å®Œæ•´æ€§** | âœ… å®Œæ•´ | âœ… å®Œæ•´ |

### æ¨èä½¿ç”¨åœºæ™¯
- **1-Pass**: è¿½æ±‚æ•ˆç‡å’Œæˆæœ¬ï¼Œé€‚åˆæ—¥å¸¸è¿è¡Œ
- **2-Pass**: éœ€è¦æ›´ç²¾ç»†çš„å·®å¼‚åŒ–è¯„åˆ†ï¼Œé€‚åˆç‰¹æ®Šåœºæ™¯

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### 2. é€‰æ‹©è¯„åˆ†ç³»ç»Ÿ

#### æ–¹å¼1: ä½¿ç”¨1-Passï¼ˆæ¨èï¼‰
å¤åˆ¶é…ç½®æ–‡ä»¶ï¼š
```bash
cp config/config-1pass.yaml config/config.yaml
```

ç¼–è¾‘é…ç½®ï¼š
```yaml
smart_ai:
  provider: "zhipu"  # å¯é€‰: gemini, openai, claude, deepseek, zhipuç­‰
```

#### æ–¹å¼2: ä½¿ç”¨2-Pass
ç¼–è¾‘ `config/config.yaml`ï¼š
```yaml
ai:
  ai_provider: "zhipu"  # å¯é€‰: gemini, openai, claude, deepseek, zhipuç­‰
  use_2pass: true
```

### 3. é…ç½®APIå¯†é’¥
è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
export ZHIPU_API_KEY="your-api-key"  # æ ¹æ®é€‰æ‹©çš„æä¾›å•†è®¾ç½®
```

### 4. è¿è¡Œç³»ç»Ÿ
```bash
python src/main.py
```

## 1-Pass ç³»ç»Ÿé…ç½®

### åŸºæœ¬é…ç½®
```yaml
# config/config-1pass.yaml
smart_ai:
  # æ ¸å¿ƒé…ç½®ï¼ˆ2é¡¹ï¼‰
  provider: "zhipu"
  
  # æä¾›å•†é…ç½®
  providers_config:
    zhipu:
      api_key: "${ZHIPU_API_KEY}"
      base_url: "https://open.bigmodel.cn/api/paas/v4"
      model: "glm-4-flash"
      max_tokens: 65536
      batch_size: 10
      max_concurrent: 3
  
  # æ€§èƒ½é…ç½®ï¼ˆ4é¡¹ï¼‰
  batch_size: 10              # æ‰¹æ¬¡å¤§å°
  max_concurrent: 3           # æœ€å¤§å¹¶å‘æ‰¹æ¬¡
  timeout_seconds: 90         # è¶…æ—¶æ—¶é—´
  max_output_items: 30        # æœ€å¤§è¾“å‡ºæ–°é—»æ•°
  
  # ç­›é€‰é…ç½®ï¼ˆ1é¡¹ï¼‰
  diversity_weight: 0.3       # å¤šæ ·æ€§æƒé‡
  
  # è¯„åˆ†æ ‡å‡†
  scoring_criteria:
    importance: 0.30
    timeliness: 0.20
    technical_depth: 0.20
    audience_breadth: 0.15
    practicality: 0.15

# åŠŸèƒ½å¼€å…³
use_smart_scorer: true        # å¯ç”¨1-Pass
```

### å·¥ä½œæµç¨‹
1. **æ™ºèƒ½åˆ†æ‰¹**: æŒ‰æ‰¹æ¬¡å¤§å°è‡ªåŠ¨åˆ†ç»„
2. **1-Passè¯„åˆ†**: å•æ¬¡APIè°ƒç”¨å®Œæˆåˆ†ç±»+è¯„åˆ†+æ€»ç»“
3. **æ™ºèƒ½ç­›é€‰**: åˆ†æ•°+å¤šæ ·æ€§åŒé‡ç­›é€‰

## 2-Pass ç³»ç»Ÿé…ç½®

### åŸºæœ¬é…ç½®
```yaml
# config/config.yaml
ai:
  use_2pass: true  # å¯ç”¨2-Passè¯„åˆ†ç³»ç»Ÿ
  
  # Pass 1 å·®å¼‚åŒ–é˜ˆå€¼
  pass1_threshold_finance: 5.5  # è´¢ç»æ–°é—»é˜ˆå€¼
  pass1_threshold_tech: 6.0     # ç§‘æŠ€æ–°é—»é˜ˆå€¼  
  pass1_threshold_politics: 5.5 # ç¤¾ä¼šæ”¿æ²»æ–°é—»é˜ˆå€¼
  
  # æ¿å—é…é¢
  category_quota_finance: 0.40  # è´¢ç»40%
  category_quota_tech: 0.30     # ç§‘æŠ€30%
  category_quota_politics: 0.30 # ç¤¾ä¼šæ”¿æ²»30%

output:
  max_news_count: 30  # æ¯æœŸè¾“å‡º30æ¡æ–°é—»
```

### å·¥ä½œæµç¨‹
1. **Pass 1**: å¿«é€Ÿé¢„ç­›ï¼ŒæŒ‰æ¿å—å·®å¼‚åŒ–é˜ˆå€¼è¿‡æ»¤
2. **Pass 2**: æ·±åº¦è¯„åˆ†ï¼ŒAIè¿›è¡Œå®Œæ•´5ç»´åº¦è¯„ä¼°
3. **æœ€ç»ˆé€‰å–**: æŒ‰å›ºå®šæ¯”ä¾‹ä»å„æ¿å—é€‰å–Top Næ–°é—»

## é¡¹ç›®ç»“æ„

```
news-coma/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ config.yaml              # ä¸»é…ç½®æ–‡ä»¶ï¼ˆ2-Passï¼‰
â”‚   â””â”€â”€ config-1pass.yaml        # 1-Passé…ç½®æ–‡ä»¶
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.py                  # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ config.py                # é…ç½®è§£æ
â”‚   â”œâ”€â”€ models.py                # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ SmartScorer/             # 1-Passè¯„åˆ†ç³»ç»Ÿï¼ˆæ–°ï¼‰
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ smart_scorer.py      # æ ¸å¿ƒåè°ƒå™¨
â”‚   â”‚   â”œâ”€â”€ batch_provider.py    # æ‰¹é‡APIç®¡ç†
â”‚   â”‚   â”œâ”€â”€ prompt_engine.py     # Promptç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ result_processor.py  # ç»“æœè§£æ
â”‚   â”œâ”€â”€ AIScorer/                # 2-Passè¯„åˆ†ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ ai_scorer.py
â”‚   â”‚   â”œâ”€â”€ provider_manager.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ ab_test_bridge.py        # A/Bæµ‹è¯•æ¡¥æ¥
â”‚   â”œâ”€â”€ history_manager.py       # å†å²è®°å½•å’Œç¼“å­˜
â”‚   â””â”€â”€ rss_parser.py            # RSSè§£æå™¨
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_smart_scorer.py     # 1-Passå•å…ƒæµ‹è¯•
â”‚   â””â”€â”€ performance_test.py      # æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ tools/
â”‚   â””â”€â”€ config_migrator.py       # é…ç½®è¿ç§»å·¥å…·
â”œâ”€â”€ data/                        # æ•°æ®ç›®å½•
â”œâ”€â”€ docs/                        # æ–‡æ¡£ç›®å½•
â”‚   â””â”€â”€ 2pass-system.md          # 2-Passç³»ç»Ÿè¯¦ç»†æ–‡æ¡£
â””â”€â”€ outputs/                     # è¾“å‡ºæ–‡ä»¶
```

## è®¸å¯è¯

MIT License

